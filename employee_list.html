<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja"><head><!-- don't edit start --><title>S2Click-Employee List</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><link href="s2click.css" type="text/css" rel="stylesheet" media="screen" /><link href="seasar_b.css" type="text/css" rel="stylesheet" media="screen" /><link href="seasar_p.css" type="text/css" rel="stylesheet" media="print" /><script src="seasar_b.js" type="text/JavaScript" language="JavaScript">
</script></head>
<body style="direction: ltr;" onload="preload('ja')"><table align="left" border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" valign="top" width="780"><table class="white" border="0" cellpadding="0" cellspacing="0" width="780">
<tbody><tr><td colspan="7"><img src="images/top01_b.gif" alt="" height="5" width="780" /></td></tr><tr><td><img src="images/top02_b.gif" alt="Seasar" height="117" width="235" /></td><td colspan="3"><img src="images/top03.gif" alt="DI Container with AOP" height="117" width="289" /></td><td colspan="3"><img src="images/spacer.gif" alt="" height="117" width="256" /></td></tr><tr><td rowspan="2"><img src="images/top04.gif" alt="" height="49" width="235" /></td><td><a href="http://www.seasar.org/index.html"><img src="images/menu01_b_ja.gif" alt="" id="menu01" onmouseover="swap(1)" onmouseout="restore(1)" name="menu01" border="0" height="30" width="78" /></a></td><td><a href="http://www.seasar.org/projects.html"><img src="images/menu02_b_ja.gif" alt="" id="menu02" onmouseover="swap(2)" onmouseout="restore(2)" name="menu02" border="0" height="30" width="101" /></a></td><td><a href="http://www.seasar.org/products.html"><img src="images/menu03_b_ja.gif" alt="" id="menu03" onmouseover="swap(3)" onmouseout="restore(3)" name="menu03" border="0" height="30" width="110" /></a></td><td><a href="http://www.seasar.org/resources.html"><img src="images/menu04_b_ja.gif" alt="" id="menu04" onmouseover="swap(4)" onmouseout="restore(4)" name="menu04" border="0" height="30" width="113" /></a></td><td><img src="images/menu05_b_ja.gif" alt="" id="menu05" onmouseover="swap(5)" onmouseout="restore(5)" name="menu05" border="0" height="30" width="109" /></td><td><img src="images/menu06.gif" alt="" height="30" width="34" /></td>
</tr><tr><td colspan="6"><img src="images/spacer.gif" alt="" height="19" width="545" /></td></tr></tbody></table><table class="white" border="0" cellpadding="0" cellspacing="0" width="780"><tbody><tr align="left" valign="top"><td width="14"><img src="images/spacer.gif" alt="" height="14" width="14" /></td><td class="main" width="740"><!-- don't edit end --><!-- document start -->
<dl>
<dd>&nbsp;</dd>

<h3><a name="document" id="document">Employee List
</a></h3>
</dl>
<img src="images/list1.jpeg" />
<dl>
<dd>Search画面で入力された検索条件に合致したRecordをTableで一覧表示します。なお現在はすべての項目が空白の場合全件検索になっていますが、実際の業務画面では、この場合 Errorにするかあるいは、件数を絞って表示する様な機能の追加が必要です。</dd>
</dl>

<dl>
<dd>今回は、Seasar Projectの<a href="http://dbflute.sandbox.seasar.org/ja/">DBFlute</a>を使用して、Dataの読み込みを行っています。</dd>
</dl>
<dl>
<dd>全ソースリストは、以下の通りです。</dd>
</dl>
<!--code start-->
<div class="excode"><pre>
<code>
public class ListPage extends BorderPage {
	public Table table = new Table();
	private EmployeeBhv employeeBhv;
	private EmployeeSearchDto employeeSearchDto;
    public ActionLink editLink = new ActionLink("edit", "Edit", this, "onEditClick");
    public ActionLink deleteLink = new ActionLink("delete", "Delete", this, "onDeleteClick");

	public ListPage() {
		table.addColumn(new Column("id"));
		table.addColumn(new Column("empno"));
		table.addColumn(new Column("empname"));
		table.addColumn(new Column("job"));
		table.addColumn(new Column("managerName"));
        Column column = new Column("hiredate");
        column.setFormat("{0,date,medium}");
		table.addColumn(column);
        column = new Column("salary");
        column.setFormat("{0,number,#,###}");
		table.addColumn(column);
		table.addColumn(new Column("deptName"));
        column = new Column("Action");
        ActionLink[] links = new ActionLink[]{editLink, deleteLink};
        column.setDecorator(new LinkDecorator(table, links, "id"));
        table.addColumn(column);
        deleteLink.setAttribute("onclick", "return window.confirm('削除していいですか');");

	}
	public void onInit() {
		employeeSearchDto = 
			(EmployeeSearchDto) getContext().getSession().getAttribute("employeeSearchDto");
	}
	public void onRender() {
		if (employeeSearchDto!=null){
			List <Employee> employees = 
				employeeBhv.getMyDao().searchEmployeeDtoList(employeeSearchDto);
			table.setRowList(employees);
		}
	}
    public boolean onEditClick() {
        Integer id = editLink.getValueInteger();
		setRedirect(getContext().getPagePath(EditPage.class) + "?mode=edit&id="+id.toString());
        return false;
    }

    public boolean onDeleteClick() {
    	Integer id = deleteLink.getValueInteger();
    	Employee emp = employeeBhv.getMyDao().getEntity(new BigDecimal(id));
    	try {
    		employeeBhv.getMyDao().delete(emp);
		}
		catch (Exception e) {
			//TO-DO Errorの表示が必要
			//setError("Delete Error 最初からやり直して下さい");
			return true;
		}
        return true;
    }

	public void setEmployeeBhv(EmployeeBhv employeeBhv) {
		this.employeeBhv = employeeBhv;
	}
}
</code>
</pre></div>
<!--code end-->

<ul>
<li><a href="employee_edit.html">employee Edit サンプル</a></li>
  	<li><a href="index.html">S2Click Home</a></li>
    <li><a href="sample.html">Sampleを見てみよう</a></li>
  </ul>
<!-- document end -->
<!-- don't edit start --></td><td width="14"><img src="images/spacer.gif" alt="" height="14" width="14" /></td></tr><tr><td width="14"><img src="images/spacer.gif" alt="" height="30" width="14" /></td><td width="766"><img src="images/spacer.gif" alt="" height="30" width="592" /></td></tr><tr><td width="14"><img src="images/spacer.gif" alt="" height="14" width="14" /></td><td class="copyright" width="766">Copyright&copy;
2004-2005, The Seasar Foundation and the others. All rights reserved.</td>
</tr></tbody></table></td><td class="backright" align="left" valign="top">&nbsp;</td>
</tr><tr><td class="backunder" align="left" height="16" valign="top" width="780">&nbsp;</td>
<td class="backcorner" align="left" height="16" valign="top">&nbsp;</td>
</tr></tbody></table><!-- don't edit end --></body></html>